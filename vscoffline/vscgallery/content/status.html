<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Server Status - Offline VSCode Gallery</title>
        <link href="{BOOTSTRAP_CSS_URL}" rel="stylesheet">
        <link href="{BOOTSTRAP_ICONS_URL}" rel="stylesheet">
        <style>
            /* Skip link for keyboard navigation */
            .skip-link {{
                position: absolute;
                top: -40px;
                left: 6px;
                background: #000;
                color: #fff;
                padding: 8px;
                text-decoration: none;
                z-index: 1000;
                border-radius: 4px;
            }}
            .skip-link:focus {{
                top: 6px;
            }}
            
            .hero-section {{ 
                background: linear-gradient(135deg, #007acc 0%, #0056b3 100%);
                color: white;
                padding: 4rem 0;
            }}
            
            .feature-card {{
                height: 100%;
                border: 2px solid transparent;
            }}
            
            /* Respect reduced motion preferences */
            @media (prefers-reduced-motion: no-preference) {{
                .feature-card {{
                    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
                }}
                .feature-card:hover {{
                    transform: translateY(-5px);
                    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                }}
            }}
            
            /* Enhanced focus indicators */
            .feature-card:focus-within {{
                border-color: #0d6efd;
                outline: 3px solid #0d6efd;
                outline-offset: 2px;
            }}
            
            .btn:focus {{
                box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25);
            }}
            
            .stat-card {{
                background: linear-gradient(135deg, #198754 0%, #20c997 100%);
                color: white;
            }}
            
            /* Ensure sufficient contrast for text on gradients */
            .stat-card .card-body {{
                background: rgba(0, 0, 0, 0.1);
                border-radius: 0.375rem;
            }}
            
            /* High contrast mode support */
            @media (prefers-contrast: high) {{
                .hero-section {{
                    background: #000;
                    border: 2px solid #fff;
                }}
                .feature-card {{
                    border: 2px solid #000;
                }}
                .stat-card {{
                    background: #000;
                    border: 2px solid #fff;
                }}
            }}
            
            /* Screen reader only text */
            .visually-hidden-focusable:not(:focus):not(:focus-within) {{
                position: absolute !important;
                width: 1px !important;
                height: 1px !important;
                padding: 0 !important;
                margin: -1px !important;
                overflow: hidden !important;
                clip: rect(0, 0, 0, 0) !important;
                white-space: nowrap !important;
                border: 0 !important;
            }}
            
            /* Status-specific styles */
            .status-ready {{ 
                background: linear-gradient(135deg, #28a745, #20c997);
            }}
            .status-loading {{ 
                background: linear-gradient(135deg, #ffc107, #fd7e14);
            }}
            
            /* Simple spinning animation using transform */
            .spinning {{
                animation: spin 2s linear infinite;
            }}
            
            /* Define spin animation without percentage symbols */
            @-webkit-keyframes spin {{
                from {{ transform: rotate(0deg); }}
                to {{ transform: rotate(360deg); }}
            }}
            
            @keyframes spin {{
                from {{ transform: rotate(0deg); }}
                to {{ transform: rotate(360deg); }}
            }}
        </style>
    </head>
<body class="bg-light">
    <!-- Skip navigation for keyboard users -->
    <a href="#main-content" class="skip-link visually-hidden-focusable">Skip to main content</a>
    
    <!-- Hero Section -->
    <header class="hero-section" role="banner">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-3">
                        Offline VSCode Marketplace Server Status
                        <i class="bi bi-{STATUS_ICON} me-3 {STATUS_ANIMATION}" aria-hidden="true"></i>
                    </h1>
                    <p class="lead mb-4">
                        {STATUS_TEXT} • {LOADING_PROGRESS}
                    </p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container my-5">
        <!-- Status Overview Cards -->
        <section class="row mb-5" aria-labelledby="metrics-heading">
            <div class="col-12 mb-4">
                <h2 id="metrics-heading" class="visually-hidden">Server Metrics</h2>
            </div>
            
            <div class="col-md-4 mb-4">
                <article class="card feature-card border-0 shadow h-100" 
                         role="region" 
                         aria-labelledby="extensions-title">
                    <div class="card-body text-center p-4 d-flex flex-column">
                        <div class="mb-3" aria-hidden="true">
                            <i class="bi bi-puzzle display-4 text-primary"></i>
                        </div>
                        <h3 id="extensions-title" class="card-title h4">Extensions</h3>
                        <div class="mt-auto">
                            <div class="row text-center">
                                <div class="col-12 mb-2">
                                    <div class="h2 text-primary">{EXTENSIONS_LOADED}</div>
                                    <small class="text-muted">Extensions Loaded</small>
                                </div>
                            </div>
                            <div class="row text-center">
                                <div class="col-6">
                                    <div class="h5 text-info">{TOTAL_VERSIONS}</div>
                                    <small class="text-muted">Versions</small>
                                </div>
                                <div class="col-6">
                                    <div class="h5 text-success">{UNIQUE_PUBLISHERS}</div>
                                    <small class="text-muted">Publishers</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
            
            <div class="col-md-4 mb-4">
                <article class="card feature-card border-0 shadow h-100" 
                         role="region" 
                         aria-labelledby="cache-title">
                    <div class="card-body text-center p-4 d-flex flex-column">
                        <div class="mb-3" aria-hidden="true">
                            <i class="bi bi-hdd display-4 text-success"></i>
                        </div>
                        <h3 id="cache-title" class="card-title h4">Cache Status</h3>
                        <div class="mt-auto">
                            <div class="mb-3">
                                <span class="badge bg-{CACHE_STATUS_COLOR} fs-6 py-2 px-3">
                                    {CACHE_STATUS_TEXT}
                                </span>
                            </div>
                            <div class="row text-center">
                                <div class="col-6">
                                    <div class="h5 text-primary">{CACHE_SIZE_MB}</div>
                                    <small class="text-muted">MB Size</small>
                                </div>
                                <div class="col-6">
                                    <div class="h5 text-info">{CACHE_AGE_HOURS}</div>
                                    <small class="text-muted">Hours Old</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
            
            <div class="col-md-4 mb-4">
                <article class="card feature-card border-0 shadow h-100" 
                         role="region" 
                         aria-labelledby="server-title">
                    <div class="card-body text-center p-4 d-flex flex-column">
                        <div class="mb-3" aria-hidden="true">
                            <i class="bi bi-server display-4 text-info"></i>
                        </div>
                        <h3 id="server-title" class="card-title h4">Server Info</h3>
                        <div class="mt-auto">
                            <div class="mb-3">
                                <div class="h2 text-primary">{UPTIME_HOURS}h</div>
                                <small class="text-muted">Uptime</small>
                            </div>
                            <div class="text-center">
                                <span class="badge bg-success fs-6 py-2 px-3">
                                    Online
                                </span>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </section>

        <!-- Categories Section -->
        <section class="row mb-5" aria-labelledby="categories-heading">
            <div class="col-12">
                <article class="card stat-card border-0 shadow" 
                         role="region" 
                         aria-labelledby="categories-title">
                    <div class="card-body p-4">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h3 id="categories-title" class="card-title mb-2 h5">
                                    <i class="bi bi-tags me-2" aria-hidden="true"></i>
                                    Popular Extension Categories
                                </h3>
                                <p class="card-text mb-0">
                                    {CATEGORIES_LIST}
                                </p>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="small text-light opacity-75">
                                    Based on sample of loaded extensions
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </section>

        <!-- Quick Links -->
        <section class="row" aria-labelledby="links-heading">
            <div class="col-12">
                <article class="card border-0 shadow" 
                         role="region" 
                         aria-labelledby="links-title">
                    <div class="card-body p-4">
                        <h3 id="links-title" class="card-title mb-3 h5">
                            <i class="bi bi-link-45deg me-2" aria-hidden="true"></i>
                            Quick Links
                        </h3>
                        <nav aria-label="Navigation links">
                            <div class="d-flex gap-3 flex-wrap mb-3">
                                <a href="/" class="btn btn-primary" aria-describedby="home-desc">
                                    <i class="bi bi-house-door me-1" aria-hidden="true"></i>
                                    Home
                                </a>
                                <a href="/status.json" class="btn btn-outline-primary" aria-describedby="json-status-desc">
                                    <i class="bi bi-file-earmark-code me-1" aria-hidden="true"></i>
                                    JSON Status
                                </a>
                                <a href="/browse?path=extensions" class="btn btn-outline-success" aria-describedby="browse-ext-desc">
                                    <i class="bi bi-puzzle me-1" aria-hidden="true"></i>
                                    Browse Extensions
                                </a>
                                <a href="/browse?path=installers" class="btn btn-outline-info" aria-describedby="browse-inst-desc">
                                    <i class="bi bi-download me-1" aria-hidden="true"></i>
                                    Browse Installers
                                </a>
                            </div>
                            <span id="home-desc" class="visually-hidden">Return to main page</span>
                            <span id="json-status-desc" class="visually-hidden">Get server status as JSON data</span>
                            <span id="browse-ext-desc" class="visually-hidden">Browse extension files with search and pagination</span>
                            <span id="browse-inst-desc" class="visually-hidden">Browse VS Code installer files</span>
                        </nav>
                        <small class="text-muted" role="status">
                            <i class="bi bi-clock me-1" aria-hidden="true"></i>
                            Last updated: {LAST_UPDATED} • Auto-refresh every 30 seconds
                        </small>
                    </div>
                </article>
            </div>
        </section>
    </main>

        <script src="{BOOTSTRAP_JS_URL}"></script>
    <script>
        // Auto-refresh every 30 seconds
        setTimeout(() => location.reload(), 30000);
        
        // Announce refresh to screen readers
        setTimeout(() => {{
            const announcement = document.createElement('div');
            announcement.setAttribute('aria-live', 'polite');
            announcement.className = 'visually-hidden';
            announcement.textContent = 'Status page will refresh in 5 seconds';
            document.body.appendChild(announcement);
        }}, 25000);
    </script>
</body>
</html>